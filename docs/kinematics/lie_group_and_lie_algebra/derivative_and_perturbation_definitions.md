# Derivative and Perturbation Definitions

## Definitions

There are four types of derivative and perturbation definitions as summarized in the table below.

| Function Type | Conditions | Derivative and Perturbation |
| - | - | - |
| Vector Space to Vector Space | Given a function $f \ : \ \mathbb{R}^m \rightarrow \mathbb{R}^n$ with operator $\left\{+, - \right\}$ and $\mathbf{x} \in \mathbb{R}^m$ | $\begin{align*} \frac{\partial f(\mathbf{x})}{\partial \mathbf{x}} &\triangleq \lim_{\delta \mathbf{x} \rightarrow \mathbf{0}} \frac{f(\mathbf{x} + \delta \mathbf{x}) - f(\mathbf{x})}{\delta \mathbf{x}} \in \mathbb{R}^{n \times m} \\ f(\mathbf{x} + \Delta \mathbf{x}) &\approx f(\mathbf{x}) + \frac{\partial f(\mathbf{x})}{\partial \mathbf{x}} \Delta \mathbf{x} \in \mathbb{R}^n \end{align*}$ |
| $SO(3)$ to $SO(3)$ | Given a function $f \ : \ SO(3) \rightarrow SO(3)$ with operator $\left\{ \oplus, \ominus \right\}$, $\mathbf{R} \in SO(3)$ and a local, small angular variation $\boldsymbol{\theta} \in \mathbb{R}^3$ | $\begin{align*}\frac{\partial f(\mathbf{R})}{\partial \boldsymbol{\theta}} &\triangleq \lim_{\delta \boldsymbol{\theta} \rightarrow \mathbf{0}} \frac{f(\mathbf{R} \oplus \delta \boldsymbol{\theta}) \ominus f(\mathbf{R})}{\delta \boldsymbol{\theta}} \\ &= \lim_{\delta \boldsymbol{\theta} \rightarrow \mathbf{0}} \frac{\left[ \ln \left( f^{-1}(\mathbf{R}) f(\mathbf{R} \exp \left[ \delta \boldsymbol{\theta} \right]_\times ) \right) \right]_{-\times}}{\delta \boldsymbol{\theta}} \in \mathbb{R}^{3 \times 3} \\ f(\mathbf{R} \oplus \Delta \boldsymbol{\theta}) &\approx f(\mathbf{R}) \oplus \frac{\partial f(\mathbf{R})}{\partial \boldsymbol{\theta}} \Delta \boldsymbol{\theta} \\ &\triangleq f(\mathbf{R}) \exp \left[ \frac{\partial f(\mathbf{R})}{\partial \boldsymbol{\theta}} \Delta \boldsymbol{\theta} \right]_\times \in SO(3) \end{align*}$ |
| Vector Space to $SO(3)$| Given a function $f \ : \ \mathbb{R}^m \rightarrow SO(3)$ with operator $\left\{+, \ominus \right\}$ and $\mathbf{x} \in \mathbb{R}^m$ | $\begin{align*} \frac{\partial f(\mathbf{x})}{\partial \mathbf{x}} &\triangleq \lim_{\delta \mathbf{x} \rightarrow \mathbf{0}} \frac{f(\mathbf{x} + \delta \mathbf{x}) \ominus f(\mathbf{x})}{\delta \mathbf{x}} \\ &= \lim_{\delta \mathbf{x} \rightarrow \mathbf{0}} \frac{\left[ \ln \left(f^{-1}(\mathbf{x}) f(\mathbf{x + \delta \mathbf{x}}) \right) \right]_{-\times}}{\delta \mathbf{x}} \in \mathbb{R}^{3 \times m} \\ f(\mathbf{x} + \Delta \mathbf{x}) &\approx f(\mathbf{x}) \oplus \frac{\partial f(\mathbf{x})}{\partial \mathbf{x}} \Delta \mathbf{x} \triangleq f(\mathbf{x}) \exp \left( \left[ \frac{\partial f(\mathbf{x})}{\partial \mathbf{x}} \Delta \mathbf{x} \right]_\times \right) \in SO(3) \end{align*}$ |
| $SO(3)$ to Vector Space | Given $f \ : \ SO(3) \rightarrow \mathbb{R}^n$ with operator $\left\{\oplus, - \right\}$ and $\boldsymbol{\theta} \in \mathbb{R}^3, \ \mathbf{R} \in SO(3)$ | $\begin{align*} \frac{\partial f(\mathbf{R})}{\partial \boldsymbol{\theta}} &\triangleq \lim_{\delta \boldsymbol{\theta} \rightarrow \mathbf{0}} \frac{f(\mathbf{R} \oplus \boldsymbol {\theta}) - f(\mathbf{R})}{\delta \boldsymbol{\theta}} \\ &= \lim_{\delta \boldsymbol{\theta} \rightarrow \mathbf{0}} \frac{f(\mathbf{R} \exp \left[ \delta \boldsymbol{\theta} \right]_\times) - f(\mathbf{R})}{\delta \boldsymbol{\theta}} \in \mathbb{R}^{n \times 3} \\ f(\mathbf{R} \oplus \Delta \boldsymbol{\theta}) &\approx f(\mathbf{R}) + \frac{\partial f(\mathbf{R})}{\partial \boldsymbol{\theta}} \Delta \boldsymbol{\theta} \\ &\triangleq f(\mathbf{R}) + \exp \left[ \frac{\partial f(\mathbf{R})}{\partial \boldsymbol{\theta}} \Delta \boldsymbol{\theta} \right]_\times \in \mathbb{R}^n \end{align*}$ |

## References

1. Barfoot, T., **State Estimation for Robotics**
2. Sol√†, J., **Quaternion Kinematics for the Error-State Kalman Filter, 2017**
